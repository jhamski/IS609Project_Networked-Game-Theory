---
title: "IS609 - Networked Game Theory - Final Project"
author: "J. Hamski, S. Hong, H. Berk"
date: "April 9, 2016"
output: html_document
---

```{r}
library(igraph)
library(ggplot2)
```

Iterated Prisoner's Dilemma on a Graph.

The classic two person Prisoner's Dilemma. 

```{r}
nodes <- 4
degree <- 2
g.1 <- degree.sequence.game(rep(degree, nodes), method =  "vl")

#randomply select strategy
# 1 = defect, 2 = cooperate
V(g.1)$strategy <- sample(c(1,2), size = length(V(g.1)), replace = T)

V(g.1)[strategy == 1]$color <- 'red' # defect
V(g.1)[strategy == 2]$color <- 'blue' # cooperate
```

```{r}
plot(g.1)
```

Need to re-write this - it doesn't take into account the player's strategy, only the opponents!
```{r}
network.evaluation <- function(g){
  network.results <- NULL
  
  for(i in 1:nodes){
    
    opponents <- neighbors(g, i, mode="all")
    opponent.results <- NULL
    
    #need to incorporate players strategy -- V(g)[j]$strategy in an if/then statement?
    for(j in 1:length(opponents)){
      opponent.results <- c(opponent.results, opponents[j]$strategy)
    }
    # rbind isn't going to work when nodes have different number of edges
    network.results <- rbind(network.results, opponent.results)
  }
  return(network.results)
}
```

```{r}
PD.results.opponents <- network.evaluation(g.1)
row.names(PD.results.opponents) <- 1:4
```

```{r}
PD.results <- rowSums(PD.results.opponents)
```

```{r}
for(i in 1:nodes){
  V(g.1)[i]$result <- PD.results[i]
}
```

```{r}
V(g.1)[result == 1]$color <- 'green' # defect
V(g.1)[result == 2]$color <- 'purple' # cooperate
```


```{r}
plot(g.1)
```

```{r}
plot(V(g.1)$strategy)
```

```{r}
plot(V(g.1)$result)
```




